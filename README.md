# LogTrace Panel

一个伪装成日志查看器的 **端到端加密多人聊天室** Chrome 插件。

> 所有消息默认显示为加密文本，鼠标悬停才能看到明文。

---

## 功能特点

- 🔒 **端到端加密** - 服务器无法解密消息内容
- 👀 **防偷窥设计** - 默认显示密文，hover 才显示明文
- 🎭 **伪装界面** - 外观像开发者日志工具
- 💬 **多人实时通信** - 支持创建/加入多个数据流
- 🔑 **密码保护** - 数据流需要访问密钥才能加入

---

## 快速开始

### 1. 启动服务端

```bash
cd server
npm install
npm start
```

服务端将在 `http://localhost:3000` 运行。

### 2. 安装 Chrome 插件

1. 打开 Chrome 浏览器，进入 `chrome://extensions/`
2. 开启右上角「**开发者模式**」
3. 点击「**加载已解压的扩展程序**」
4. 选择项目中的 `extension` 文件夹

### 3. 开始使用

点击浏览器右上角的插件图标即可打开面板。

---

## 使用流程

### 创建数据流（发起者）

1. 点击「**连接**」按钮连接服务器
2. 状态变为「已连接」后，点击「**+**」按钮
3. 输入数据流名称和**访问密钥**（这是加密密码，务必记住）
4. 点击「创建」
5. **数据流 ID 会自动复制到剪贴板**，发送给朋友

### 加入数据流（参与者）

1. 点击「**连接**」按钮连接服务器
2. 状态变为「已连接」后，点击「**加入**」按钮
3. 输入朋友分享的**数据流 ID**
4. 输入**相同的访问密钥**
5. 点击「加入」

### 发送消息

加入数据流后，在底部输入框输入内容，点击「推送」或按回车发送。

### 查看消息

- **默认状态**：消息显示为加密的乱码文本
- **鼠标悬停**：悬停在消息上即可看到解密后的明文
- **鼠标移开**：立即恢复为密文显示

---

## 远程部署（可选）

如果需要在不同网络环境下使用，可以将服务端部署到云平台。

### 部署到 Render（免费）

1. 将代码上传到 GitHub
2. 访问 [render.com](https://render.com) 并登录
3. 新建 Web Service，连接你的仓库
4. 设置：
   - Root Directory: `server`
   - Build Command: `npm install`
   - Start Command: `npm start`
5. 部署完成后获取服务器地址
6. 在插件设置中填入新的服务器地址

---

## 界面说明

```
┌────────────────────────────────────────────┐
│  LogTrace 日志面板                [⚙]      │  ← 点击⚙设置服务器地址
├────────────────────────────────────────────┤
│  [选择数据流 ▼]        [连接] [+]          │  ← 连接服务器 / 创建数据流
│  ● 已连接                     2 个节点     │  ← 连接状态 / 在线人数
├────────────────────────────────────────────┤
│  [过滤日志...]              [全部 ▼] [清空]│  ← 过滤和清空日志
├────────────────────────────────────────────┤
│  14:32:05.123 [INFO] node-7f3a             │
│  > aGVsbG8gd29ybGQ=...                     │  ← 默认显示密文
│                                            │
│  14:32:06.456 [DEBUG] node-2b1c            │
│  > c2VjcmV0IG1lc3NhZ2U=...                 │  ← 鼠标悬停显示明文
├────────────────────────────────────────────┤
│  [输入追踪数据...]                  [推送] │  ← 发送消息
└────────────────────────────────────────────┘
```

---

## 安全说明

| 特性 | 说明 |
|------|------|
| 加密算法 | AES-256-GCM |
| 密钥派生 | PBKDF2 (100,000 次迭代) |
| 服务端 | 仅转发密文，无法解密 |
| 历史记录 | 不保存，关闭即清空 |

---

## 常见问题

**Q: 点击连接没反应？**
A: 检查服务端是否已启动，确保地址正确（默认 `http://localhost:3000`）

**Q: 加入数据流失败？**
A: 确认数据流 ID 和访问密钥都正确，两者缺一不可

**Q: 看不到别人创建的数据流？**
A: 这是设计如此。创建者需要将数据流 ID 分享给参与者，参与者手动输入加入

**Q: 消息显示乱码？**
A: 正常现象，鼠标悬停在消息上即可看到明文

---

## 技术栈

- **插件**: Chrome Extension (Manifest V3)
- **服务端**: Node.js + Socket.IO
- **加密**: Web Crypto API (AES-GCM + PBKDF2)

---

## 许可证

MIT License
